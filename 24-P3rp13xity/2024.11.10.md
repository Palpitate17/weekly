# 完成事项
1. BUU 第三页一半
2. python看到1/3
3. 看了费马小定理和威尔逊定理
4. 搭博客

# 下周待做事项
1. ISCTF
2. BUU第三页完成
3. python
4. 数论

# 本周学习的知识分享
## BUU
### babyrsa
直接分解n，得到p,q

```plain
import gmpy2 as gp
import binascii

p=105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141
q=144564833334456076455156647979862690498796694770100520405218930055633597500009574663803955456004439398699669751249623406199542605271188909145969364476344963078599240058180033000440459281558347909876143313940657252737586803051935392596519226965519859474501391969755712097119163926672753588797180811711004203301
e=65537
n=15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
c=7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035

phi=(p-1)*(q-1)
d=gp.invert(e,phi)
m=pow(c,d,n)
print(binascii.unhexlify(hex(m)[2:]))
```

flag{Advanced_mathematics_is_too_hard!!!}

我试了下不分解n，通过z求得p,q，由题可推出

![](https://cdn.nlark.com/yuque/0/2024/jpeg/49639454/1731229439357-48728ecb-758e-42aa-a5ec-fbcda3fb35ff.jpeg)

```plain
import gmpy2 as gp
import binascii
import math
from sympy import *

z=32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
e=65537
n=15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
c=7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035

p_and_q=gp.iroot(z+2*n,2)[0]
x=symbols('x')
res=solve([x**2-p_and_q*x+n],[x])
p=gp.mpz(res[0][0])
q=gp.mpz(res[1][0])
phi=(p-1)*(q-1)
d=gp.invert(e,phi)
m=pow(c,d,n)
print(binascii.unhexlify(hex(m)[2:]))
```

flag{Advanced_mathematics_is_too_hard!!!}

### babyRSA
p,q为1024位数，故phi为2048位数，e*d-1为2064位数，故e*d-1=k*phi中的k为16位数，即2<sup>15</sup><=k<2<sup>16</sup>,爆破出p,q

```plain
import gmpy2 as gp
import binascii
from sympy import *

e = 65537
d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804

for i in range(2**15,2**16):
    if (e*d-1)%i==0:
        phi=(e*d-1)//i
        p=prevprime(gp.iroot(phi,2)[0])
        q=nextprime(p)
        if (p-1)*(q-1)==phi:
            n=p*q
            m=pow(c,d,n)
            print(binascii.unhexlify(hex(m)[2:]))
```

flag{70u2_nn47h_14_v3ry_gOO0000000d}

### boom
运行程序，先得到一串md5，解密得到en5oy

![](https://cdn.nlark.com/yuque/0/2024/png/49639454/1731062418984-c7fabc0f-e61d-440d-916c-dd1d040e181e.png)

然后是两道解方程

> 3x-y+z=185
>
> 2x+3y-z=321
>
> x+y+z=173
>

> x*x+x-7943722218936282=0
>

```plain
from sympy import *

x=symbols("x")
y=symbols("y")
z=symbols("z")
eq1=3*x-y+z-185
eq2=2*x+3*y-z-321
eq3=x+y+z-173
print(solve([eq1,eq2,eq3],[x,y,z]))
```

> {x: 74, y: 68, z: 31}
>

```plain
from sympy import *

x=symbols("x")
eq=x*x+x-7943722218936282
print(solve(eq,x))
```

> [-89127562, 89127561]
>

第二个方程输入正数时得到正确flag

# 本周学习总结
搭博客的时候要被报错给搞疯了，幸亏最后搭起来了。这周除了博客，其他的没弄多少，在忙着复习准备期中考，但愿能考好吧

